{% extends 'base.html' %}

{% block title %}Todo List{% endblock %}

{% block content %}
<div class="row">
    <div class="col-md-8">
        <h1>My Todos</h1>
    </div>
    <div class="col-md-4">
        <a href="{% url 'todo-create' %}" class="btn btn-primary float-end">+ Add Todo</a>
    </div>
</div>
<hr>

{% if todos %}
    {% for todo in todos %}
    <div class="todo-item {% if todo.resolved %}resolved{% endif %}">
        <div class="row">
            <div class="col-md-9">
                <h5 class="todo-title">{{ todo.title }}</h5>
                {% if todo.description %}
                <p class="text-muted">{{ todo.description }}</p>
                {% endif %}
                {% if todo.due_date %}
                <div class="due-date">
                    <strong>Due:</strong> {{ todo.due_date|date:"M d, Y" }}
                </div>
                {% endif %}
            </div>
            <div class="col-md-3">
                <div class="btn-group-sm d-flex justify-content-end">
                    <form method="post" action="{% url 'todo-resolve' todo.pk %}" style="display: inline;">
                        {% csrf_token %}
                        <button type="submit" class="btn {% if todo.resolved %}btn-success{% else %}btn-warning{% endif %} btn-sm">
                            <i class="bi {% if todo.resolved %}bi-check-circle-fill{% else %}bi-check-circle{% endif %}"></i>
                            {% if todo.resolved %}Done{% else %}Mark Done{% endif %}
                        </button>
                    </form>
                    <a href="{% url 'todo-edit' todo.pk %}" class="btn btn-info btn-sm"><i class="bi bi-pencil"></i> Edit</a>
                    <a href="{% url 'todo-delete' todo.pk %}" class="btn btn-danger btn-sm"><i class="bi bi-trash"></i> Delete</a>
                </div>
            </div>
        </div>
    </div>
    {% endfor %}
{% else %}
    <div class="alert alert-info">
        <p>No todos yet. <a href="{% url 'todo-create' %}">Create one</a></p>
    </div>
{% endif %}
{% endblock %}
